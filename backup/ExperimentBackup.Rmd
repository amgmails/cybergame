---
title: "ExperimentBackup"
author: "Maixent ASSI"
date: "28/07/2019"
output: html_document
---

```{r setup, include=FALSE}
# history <- read.csv("history.csv", header = F)
# history <- history[,-dim(history)[2]]
# 
# library(caret)
# inTraining <- createDataPartition(history$V19, p = .75, list = FALSE)
# training <- history[ inTraining,]
# testing  <- history[-inTraining,]
# 
# fitControl <- trainControl(## 10-fold CV
#                            method = "repeatedcv",
#                            number = 10,
#                            ## repeated ten times
#                            repeats = 10)
# gpGrid <-  expand.grid(sigma = seq(from = 0.01, to=  1, by = 0.01))
# 
# gpFit1 <- train(V19 ~ ., data = training, 
#                  method = "gaussprRadial", 
#                  trControl = fitControl,
#                   tuneGrid = gpGrid,
#                  verbose = FALSE)
# 
# gpFit1

# rbfGrid <-  expand.grid(size = c(10,20,30,40,50,60,70,80,90,100))
# 
# rbfFit1 <- train(V19 ~ ., data = training, 
#                  method = "rbf", 
#                  trControl = fitControl,
#                   tuneGrid = rbfGrid,
#                  verbose = FALSE)
# 
# rbfFit1

# svmGrid <- expand.grid(sigma = c(0.02, 0.05, 0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1)
#                        , C = seq(from = 10, to = 50, by = 10))
# 
# svmFit1 <- train(V19 ~ ., data = training,
#                  method = "svmRadial",
#                  trControl = fitControl,
#                   tuneGrid = svmGrid,
#                  verbose = FALSE)
# 
# svmFit1
```

## R Markdown

Gaussian Process with Radial Basis Function Kernel 

586 samples
 18 predictor

No pre-processing
Resampling: Cross-Validated (10 fold, repeated 10 times) 
Summary of sample sizes: 526, 529, 528, 526, 528, 528, ... 
Resampling results across tuning parameters:

  sigma  RMSE      Rsquared   MAE     
  0.01   23.80854  0.6759783  18.34310
  0.02   23.74075  0.6760988  18.24578
  0.03   24.10069  0.6658468  18.48348
  0.04   24.53620  0.6537724  18.79851
  0.05   24.96084  0.6420703  19.11785
  0.06   25.36238  0.6310997  19.43457
  0.07   25.74802  0.6207175  19.73637
  0.08   26.12794  0.6106828  20.02528
  0.09   26.51042  0.6007838  20.32302
  0.10   26.90076  0.5908699  20.63351
  0.11   27.30137  0.5808522  20.95554
  0.12   27.71228  0.5706929  21.29052
  0.13   28.13168  0.5603941  21.64538
  0.14   28.55646  0.5499874  22.01482
  0.15   28.98271  0.5395245  22.39051
  0.16   29.40620  0.5290689  22.76723
  0.17   29.82276  0.5186886  23.14201
  0.18   30.22861  0.5084500  23.50618
  0.19   30.62058  0.4984132  23.85535
  0.20   30.99624  0.4886285  24.20128
  0.21   31.35392  0.4791354  24.53917
  0.22   31.69267  0.4699610  24.85772
  0.23   32.01219  0.4611214  25.15815
  0.24   32.31272  0.4526222  25.44128
  0.25   32.59489  0.4444603  25.70919
  0.26   32.85966  0.4366254  25.96208
  0.27   33.10815  0.4291018  26.20166
  0.28   33.34159  0.4218699  26.42675
  0.29   33.56125  0.4149077  26.63821
  0.30   33.76839  0.4081918  26.83515
  0.31   33.96419  0.4016987  27.01770
  0.32   34.14978  0.3954053  27.18808
  0.33   34.32617  0.3892895  27.34712
  0.34   34.49428  0.3833308  27.49592
  0.35   34.65495  0.3775102  27.63462
  0.36   34.80889  0.3718109  27.76558
  0.37   34.95675  0.3662177  27.89036
  0.38   35.09906  0.3607176  28.01056
  0.39   35.23631  0.3552994  28.12753
  0.40   35.36890  0.3499538  28.24141
  0.41   35.49719  0.3446729  28.35003
  0.42   35.62147  0.3394508  28.45510
  0.43   35.74199  0.3342827  28.55613
  0.44   35.85897  0.3291651  28.65306
  0.45   35.97259  0.3240956  28.74577
  0.46   36.08301  0.3190730  28.83443
  0.47   36.19036  0.3140968  28.91915
  0.48   36.29477  0.3091671  29.00007
  0.49   36.39633  0.3042847  29.07752
  0.50   36.49513  0.2994509  29.15204
  0.51   36.59125  0.2946674  29.22364
  0.52   36.68478  0.2899362  29.29242
  0.53   36.77576  0.2852593  29.35860
  0.54   36.86427  0.2806390  29.42211
  0.55   36.95037  0.2760777  29.48308
  0.56   37.03410  0.2715776  29.54177
  0.57   37.11554  0.2671411  29.59810
  0.58   37.19472  0.2627703  29.65218
  0.59   37.27171  0.2584673  29.70481
  0.60   37.34655  0.2542339  29.75585
  0.61   37.41930  0.2500719  29.80543
  0.62   37.49000  0.2459828  29.85389
  0.63   37.55872  0.2419679  29.90097
  0.64   37.62550  0.2380283  29.94642
  0.65   37.69039  0.2341650  29.99071
  0.66   37.75344  0.2303786  30.03409
  0.67   37.81470  0.2266695  30.07626
  0.68   37.87422  0.2230381  30.11731
  0.69   37.93206  0.2194845  30.15704
  0.70   37.98826  0.2160085  30.19542
  0.71   38.04286  0.2126098  30.23251
  0.72   38.09592  0.2092881  30.26843
  0.73   38.14749  0.2060427  30.30317
  0.74   38.19760  0.2028728  30.33678
  0.75   38.24631  0.1997777  30.36933
  0.76   38.29365  0.1967564  30.40084
  0.77   38.33968  0.1938078  30.43142
  0.78   38.38443  0.1909307  30.46110
  0.79   38.42794  0.1881240  30.48989
  0.80   38.47026  0.1853863  30.51792
  0.81   38.51142  0.1827163  30.54521
  0.82   38.55146  0.1801127  30.57167
  0.83   38.59042  0.1775740  30.59742
  0.84   38.62834  0.1750987  30.62245
  0.85   38.66524  0.1726854  30.64685
  0.86   38.70116  0.1703327  30.67061
  0.87   38.73614  0.1680389  30.69376
  0.88   38.77020  0.1658027  30.71638
  0.89   38.80337  0.1636226  30.73854
  0.90   38.83569  0.1614971  30.76044
  0.91   38.86718  0.1594247  30.78222
  0.92   38.89787  0.1574041  30.80348
  0.93   38.92778  0.1554337  30.82416
  0.94   38.95694  0.1535122  30.84431
  0.95   38.98538  0.1516383  30.86395
  0.96   39.01312  0.1498106  30.88312
  0.97   39.04017  0.1480277  30.90179
  0.98   39.06656  0.1462885  30.91997
  0.99   39.09232  0.1445916  30.93767
  1.00   39.11746  0.1429358  30.95491

RMSE was used to select the optimal model using the smallest value.
The final value used for the model was sigma = 0.02.


Radial Basis Function Network 

587 samples
 18 predictor

No pre-processing
Resampling: Cross-Validated (10 fold, repeated 10 times) 
Summary of sample sizes: 527, 527, 528, 528, 528, 528, ... 
Resampling results across tuning parameters:

  size  RMSE      Rsquared   MAE     
   10   39.06178  0.1026056  30.15204
   20   38.30638  0.1399223  29.51241
   30   37.52785  0.1703756  28.98810
   40   37.15392  0.1899428  28.70773
   50   36.86379  0.2007660  28.55945
   60   36.68087  0.2090051  28.34109
   70   36.31262  0.2271131  28.08699
   80   36.07042  0.2337582  27.93379
   90   35.82742  0.2461453  27.65491
  100   35.61820  0.2561443  27.48532

RMSE was used to select the optimal model using the smallest value.
The final value used for the model was size = 100.

Support Vector Machines with Radial Basis Function Kernel 

587 samples
 18 predictor

No pre-processing
Resampling: Cross-Validated (10 fold, repeated 10 times) 
Summary of sample sizes: 528, 529, 529, 529, 528, 527, ... 
Resampling results across tuning parameters:

  sigma  C   RMSE      Rsquared   MAE     
  0.02   10  26.53132  0.5927300  20.29089
  0.02   20  27.61862  0.5674164  21.19702
  0.02   30  28.33638  0.5507496  21.83507
  0.02   40  28.95655  0.5360920  22.40097
  0.02   50  29.52940  0.5223044  22.90959
  0.05   10  28.10948  0.5429793  21.81161
  0.05   20  29.12094  0.5165170  22.77846
  0.05   30  29.79628  0.4999519  23.33560
  0.05   40  30.18075  0.4908984  23.67286
  0.05   50  30.42532  0.4852416  23.89911
  0.10   10  28.11597  0.5338934  21.79715
  0.10   20  28.56407  0.5200310  22.15645
  0.10   30  28.84051  0.5115811  22.38279
  0.10   40  29.07703  0.5044492  22.55523
  0.10   50  29.31425  0.4973969  22.73029
  0.20   10  30.31385  0.4611400  23.26108
  0.20   20  30.63223  0.4485213  23.50325
  0.20   30  30.91959  0.4375505  23.70781
  0.20   40  31.17525  0.4282874  23.88844
  0.20   50  31.38986  0.4208135  24.03567
  0.30   10  32.49308  0.3846389  25.15166
  0.30   20  32.79635  0.3708172  25.36783
  0.30   30  33.01737  0.3614718  25.51498
  0.30   40  33.19829  0.3536424  25.65421
  0.30   50  33.25877  0.3508872  25.70689
  0.40   10  34.04063  0.3274090  26.53245
  0.40   20  34.27650  0.3153455  26.71267
  0.40   30  34.34260  0.3113202  26.78168
  0.40   40  34.34782  0.3109082  26.79473
  0.40   50  34.34078  0.3112348  26.79311
  0.50   10  35.17609  0.2846449  27.57018
  0.50   20  35.28494  0.2773526  27.67551
  0.50   30  35.28628  0.2770768  27.69141
  0.50   40  35.28400  0.2772178  27.69054
  0.50   50  35.28400  0.2772178  27.69054
  0.60   10  36.10034  0.2470564  28.35016
  0.60   20  36.11250  0.2452325  28.38562
  0.60   30  36.10981  0.2453887  28.38533
  0.60   40  36.10981  0.2453882  28.38534
  0.60   50  36.10981  0.2453882  28.38534
  0.70   10  36.78274  0.2178591  28.87485
  0.70   20  36.78326  0.2173998  28.88780
  0.70   30  36.78326  0.2173998  28.88780
  0.70   40  36.78326  0.2173999  28.88780
  0.70   50  36.78326  0.2173999  28.88780
  0.80   10  37.31982  0.1942380  29.28254
  0.80   20  37.31722  0.1941962  29.28399
  0.80   30  37.31722  0.1941962  29.28399
  0.80   40  37.31722  0.1941962  29.28399
  0.80   50  37.31722  0.1941962  29.28399
  0.90   10  37.74407  0.1748628  29.62051
  0.90   20  37.74334  0.1749028  29.62015
  0.90   30  37.74334  0.1749028  29.62015
  0.90   40  37.74334  0.1749028  29.62015
  0.90   50  37.74334  0.1749028  29.62015
  1.00   10  38.08962  0.1585916  29.89240
  1.00   20  38.08962  0.1585916  29.89240
  1.00   30  38.08962  0.1585916  29.89240
  1.00   40  38.08962  0.1585916  29.89240
  1.00   50  38.08962  0.1585916  29.89240

RMSE was used to select the optimal model using the smallest value.
The final values used for the model were sigma = 0.02 and C = 10.

svmFit1
Support Vector Machines with Radial Basis Function Kernel 

587 samples
 18 predictor

No pre-processing
Resampling: Cross-Validated (10 fold, repeated 10 times) 
Summary of sample sizes: 528, 529, 527, 528, 528, 527, ... 
Resampling results across tuning parameters:

  C   RMSE      Rsquared   MAE     
  10  25.10181  0.6262359  19.08135
  20  26.03468  0.6041205  19.88572
  30  26.72599  0.5882046  20.44282
  40  27.21507  0.5769519  20.81735
  50  27.55778  0.5691928  21.07648

Tuning parameter 'sigma' was held constant at a value of 0.01
RMSE was used to select the optimal model using the smallest value.
The final values used for the model were sigma = 0.01 and C = 10.

Support Vector Machines with Radial Basis Function Kernel 

587 samples
 18 predictor

No pre-processing
Resampling: Cross-Validated (10 fold, repeated 10 times) 
Summary of sample sizes: 530, 530, 529, 527, 529, 530, ... 
Resampling results across tuning parameters:

  sigma  C   RMSE      Rsquared   MAE     
  0.001   1  26.44786  0.6292150  20.15906
  0.001   2  25.20483  0.6350375  19.05775
  0.001   3  24.86504  0.6373328  18.74082
  0.001   4  24.73539  0.6386821  18.61541
  0.001   5  24.68147  0.6393345  18.55762
  0.001   6  24.65445  0.6399200  18.53321
  0.001   7  24.63391  0.6403541  18.52119
  0.001   8  24.62030  0.6406552  18.51312
  0.001   9  24.61427  0.6408625  18.50760
  0.001  10  24.60363  0.6412449  18.49973
  0.002   1  25.17341  0.6367998  19.03964
  0.002   2  24.63209  0.6418050  18.53436
  0.002   3  24.51693  0.6439068  18.43471
  0.002   4  24.45844  0.6453622  18.39164
  0.002   5  24.39580  0.6469106  18.34330
  0.002   6  24.33548  0.6484217  18.29382
  0.002   7  24.27773  0.6499780  18.24860
  0.002   8  24.23582  0.6512007  18.21567
  0.002   9  24.20097  0.6521853  18.19341
  0.002  10  24.17038  0.6530248  18.16778
  0.003   1  24.75002  0.6413151  18.65806
  0.003   2  24.42004  0.6468273  18.37206
  0.003   3  24.28450  0.6500906  18.26167
  0.003   4  24.18662  0.6525025  18.18562
  0.003   5  24.12475  0.6542254  18.13889
  0.003   6  24.05993  0.6560036  18.07930
  0.003   7  24.00275  0.6575231  18.02698
  0.003   8  23.95603  0.6587120  17.99556
  0.003   9  23.92401  0.6595108  17.97960
  0.003  10  23.89803  0.6601320  17.96692
  0.004   1  24.50948  0.6459138  18.45722
  0.004   2  24.22203  0.6519256  18.21952
  0.004   3  24.09507  0.6550342  18.11648
  0.004   4  23.99722  0.6576282  18.02967
  0.004   5  23.92700  0.6594691  17.98108
  0.004   6  23.87958  0.6605901  17.95875
  0.004   7  23.85504  0.6611409  17.95380
  0.004   8  23.85511  0.6611241  17.96342
  0.004   9  23.86397  0.6609024  17.97455
  0.004  10  23.87527  0.6605620  17.98840
  0.005   1  24.36558  0.6493074  18.34720
  0.005   2  24.07599  0.6556379  18.10364
  0.005   3  23.94881  0.6589101  17.99783
  0.005   4  23.87423  0.6607386  17.95862
  0.005   5  23.85428  0.6611543  17.96134
  0.005   6  23.86791  0.6607887  17.98113
  0.005   7  23.89066  0.6601085  18.00343
  0.005   8  23.92206  0.6591878  18.02935
  0.005   9  23.95386  0.6583211  18.05803
  0.005  10  23.99213  0.6573111  18.09219
  0.006   1  24.22143  0.6528253  18.23218
  0.006   2  23.96942  0.6584544  18.01755
  0.006   3  23.86906  0.6608464  17.96066
  0.006   4  23.86509  0.6609140  17.97734
  0.006   5  23.89733  0.6599211  18.01039
  0.006   6  23.94173  0.6586564  18.04888
  0.006   7  23.99494  0.6572348  18.09417
  0.006   8  24.05511  0.6555219  18.15096
  0.006   9  24.11039  0.6539915  18.19798
  0.006  10  24.16480  0.6524710  18.24455
  0.007   1  24.10853  0.6555593  18.14616
  0.007   2  23.89853  0.6602602  17.97373
  0.007   3  23.87550  0.6606924  17.98663
  0.007   4  23.91641  0.6593964  18.02739
  0.007   5  23.98124  0.6575870  18.08383
  0.007   6  24.06229  0.6553130  18.15599
  0.007   7  24.13650  0.6532767  18.21932
  0.007   8  24.21016  0.6512692  18.28291
  0.007   9  24.28572  0.6492728  18.34694
  0.007  10  24.36916  0.6470614  18.41918
  0.008   1  24.02466  0.6576540  18.07268
  0.008   2  23.88773  0.6604634  17.98718
  0.008   3  23.91311  0.6595277  18.02375
  0.008   4  23.99601  0.6571743  18.09732
  0.008   5  24.10233  0.6542092  18.18992
  0.008   6  24.19507  0.6516998  18.26765
  0.008   7  24.29017  0.6491694  18.34901
  0.008   8  24.39440  0.6463807  18.43961
  0.008   9  24.51134  0.6432649  18.53814
  0.008  10  24.62664  0.6402782  18.63795
  0.009   1  23.96773  0.6590274  18.03023
  0.009   2  23.90538  0.6600119  18.01235
  0.009   3  23.97669  0.6577231  18.08171
  0.009   4  24.10779  0.6540786  18.19345
  0.009   5  24.22158  0.6510083  18.28779
  0.009   6  24.33955  0.6478513  18.39117
  0.009   7  24.47566  0.6441918  18.50641
  0.009   8  24.61743  0.6404894  18.62640
  0.009   9  24.75273  0.6370107  18.74563
  0.009  10  24.87918  0.6337576  18.85670

RMSE was used to select the optimal model using the smallest value.
The final values used for the model were sigma = 0.005 and C = 5

```{r datasets}
gp_alone <- read.csv("history_gp.csv", header = F)
gp_cem <- read.csv("history_gp_cem.csv", header = F)

svr_alone <- read.csv("history_svr.csv", header = F)
svr_cem <- read.csv("history_svr_cem.csv", header = F)

rnd_alone <- read.csv("history_rnd.csv", header = F)
rnd_cem <- read.csv("history_rnd_cem.csv", header = F)

listOfDataFrames = list(gp_alone, gp_cem, svr_alone, svr_cem, rnd_alone, rnd_cem)

thedata <- df <- do.call("rbind", listOfDataFrames)
thedata$method = rep(x = c("gp_alone", "gp_cem", "svr_alone", "svr_cem", "rnd_alone", "rnd_cem"), each = 101)
names(thedata)[19] = "score"

library(ggplot2)
ggplot(data = thedata, aes(x = rep(seq(1,101), times = 6), y = score, colour = method)) + geom_line()
ggplot(data = thedata[thedata$method %in% c("gp_alone", "svr_alone","rnd_alone"),], aes(x = rep(seq(1,101), times = 3), y = score, colour = method)) + geom_line() + facet_wrap(~method)
ggplot(data = thedata[thedata$method %in% c("gp_cem", "svr_cem","rnd_cem"),], aes(x = rep(seq(1,101), times = 3), y = score, colour = method)) + geom_line() + facet_wrap(~method)
ggplot(data = thedata[thedata$method %in% c("gp_cem", "svr_cem","rnd_cem"),], aes(x = rep(seq(1,101), times = 3), y = score, colour = method)) + geom_line() + facet_grid(method~.)
ggplot(data = thedata[thedata$method %in% c("gp_alone", "gp_cem"),], aes(x = rep(seq(1,101), times = 2), y = score, colour = method)) + geom_line()
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
